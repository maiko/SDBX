apiVersion: sdbx.io/v1
kind: Service
metadata:
  name: watchtower
  version: 1.0.0
  category: utility
  description: "Automatic container image updates"
  homepage: https://containrrr.dev/watchtower/
  documentation: https://containrrr.dev/watchtower/
  maintainer: sdbx-official
  tags:
    - automation
    - updates
    - utility

spec:
  image:
    repository: containrrr/watchtower
    tag: latest
    registry: docker.io

  container:
    name_template: "sdbx-{{ .Name }}"
    restart: unless-stopped

  environment:
    static:
      - name: TZ
        value: "{{ .Config.Timezone }}"
      - name: WATCHTOWER_CLEANUP
        value: "true"
      - name: WATCHTOWER_LABEL_ENABLE
        value: "true"
      - name: WATCHTOWER_SCHEDULE
        value: "0 0 4 * * *"

  volumes:
    - name: docker-socket
      hostPath: /var/run/docker.sock
      containerPath: /var/run/docker.sock

  networking:
    networks:
      - name: proxy

routing:
  enabled: false

integrations:
  watchtower:
    enabled: true
  cloudflared:
    enabled: false
  homepage:
    enabled: false

conditions:
  always: true
